"""
    Copyright 2000, 2001 Astrolabe by William McClain

    Forked in 2013 to Astronomia

    Copyright 2013 Astronomia by Tim Cera

    This file is part of Astronomia.

    Astronomia is free software; you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation; either version 2 of the License, or
    (at your option) any later version.

    Astronomia is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Astronomia; if not, write to the Free Software
    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
    """

"""Functions which calculate the deltaT correction to convert between
dynamical and universal time.

Reference: Jean Meeus, _Astronomical Algorithms_, second edition, 1998,
Willmann-Bell, Inc.

"""
from bisect import bisect
from astronomia.calendar import cal_to_jd, jd_to_cal
from astronomia.constants import seconds_per_day
from astronomia.util import polynomial

# _tbl is a list of tuples (jd, seconds), giving deltaT values for the
# beginnings of years in a historical range. [Meeus-1998: table 10.A]

# Updated with newer (better?) values in 2011.
# the following are not ALL from Meeus, but 1657-2010 are taken from
# http://www.iers.org/iers/earth/rotation/ut1lod/table2.html # NO LONGER THERE
# Found info here...
# http://maia.usno.navy.mil/ser7/historic_deltat.data
# With the main site here...
# http://www.usno.navy.mil/USNO/earth-orientation/eo-products/long-term

_tbl = [
    (cal_to_jd(1620), 121.0),
    (cal_to_jd(1622), 112.0),
    (cal_to_jd(1624), 103.0),
    (cal_to_jd(1626), 95.0),
    (cal_to_jd(1628), 88.0),

    (cal_to_jd(1630), 82.0),
    (cal_to_jd(1632), 77.0),
    (cal_to_jd(1634), 72.0),
    (cal_to_jd(1636), 68.0),
    (cal_to_jd(1638), 63.0),

    (cal_to_jd(1640), 60.0),
    (cal_to_jd(1642), 56.0),
    (cal_to_jd(1644), 53.0),
    (cal_to_jd(1646), 51.0),
    (cal_to_jd(1648), 48.0),

    (cal_to_jd(1650), 46.0),
    (cal_to_jd(1652), 44.0),
    (cal_to_jd(1654), 42.0),
    (cal_to_jd(1656), 40.0),

# Originally from Meeus
#    (cal_to_jd(1658), 38.0),
#
#    (cal_to_jd(1660), 35.0),
#    (cal_to_jd(1662), 33.0),
#    (cal_to_jd(1664), 31.0),
#    (cal_to_jd(1666), 29.0),
#    (cal_to_jd(1668), 26.0),
#
#    (cal_to_jd(1670), 24.0),
#    (cal_to_jd(1672), 22.0),
#    (cal_to_jd(1674), 20.0),
#    (cal_to_jd(1676), 28.0),
#    (cal_to_jd(1678), 16.0),
#
#    (cal_to_jd(1680), 14.0),
#    (cal_to_jd(1682), 12.0),
#    (cal_to_jd(1684), 11.0),
#    (cal_to_jd(1686), 10.0),
#    (cal_to_jd(1688), 9.0),
#
#    (cal_to_jd(1690), 8.0),
#    (cal_to_jd(1692), 7.0),
#    (cal_to_jd(1694), 7.0),
#    (cal_to_jd(1696), 7.0),
#    (cal_to_jd(1698), 7.0),
#
#    (cal_to_jd(1700), 7.0),
#    (cal_to_jd(1702), 7.0),
#    (cal_to_jd(1704), 8.0),
#    (cal_to_jd(1706), 8.0),
#    (cal_to_jd(1708), 9.0),
#
#    (cal_to_jd(1710), 9.0),
#    (cal_to_jd(1712), 9.0),
#    (cal_to_jd(1714), 9.0),
#    (cal_to_jd(1716), 9.0),
#    (cal_to_jd(1718), 10.0),
#
#    (cal_to_jd(1720), 10.0),
#    (cal_to_jd(1722), 10.0),
#    (cal_to_jd(1724), 10.0),
#    (cal_to_jd(1726), 10.0),
#    (cal_to_jd(1728), 10.0),
#
#    (cal_to_jd(1730), 10.0),
#    (cal_to_jd(1732), 10.0),
#    (cal_to_jd(1734), 11.0),
#    (cal_to_jd(1736), 11.0),
#    (cal_to_jd(1738), 11.0),
#
#    (cal_to_jd(1740), 11.0),
#    (cal_to_jd(1742), 11.0),
#    (cal_to_jd(1744), 12.0),
#    (cal_to_jd(1746), 12.0),
#    (cal_to_jd(1748), 12.0),
#
#    (cal_to_jd(1750), 12.0),
#    (cal_to_jd(1752), 13.0),
#    (cal_to_jd(1754), 13.0),
#    (cal_to_jd(1756), 13.0),
#    (cal_to_jd(1758), 14.0),
#
#    (cal_to_jd(1760), 14.0),
#    (cal_to_jd(1762), 14.0),
#    (cal_to_jd(1764), 14.0),
#    (cal_to_jd(1766), 15.0),
#    (cal_to_jd(1768), 15.0),
#
#    (cal_to_jd(1770), 15.0),
#    (cal_to_jd(1772), 15.0),
#    (cal_to_jd(1774), 15.0),
#    (cal_to_jd(1776), 16.0),
#    (cal_to_jd(1778), 16.0),
#
#    (cal_to_jd(1780), 16.0),
#    (cal_to_jd(1782), 16.0),
#    (cal_to_jd(1784), 16.0),
#    (cal_to_jd(1786), 16.0),
#    (cal_to_jd(1788), 16.0),
#
#    (cal_to_jd(1790), 16.0),
#    (cal_to_jd(1792), 15.0),
#    (cal_to_jd(1794), 15.0),
#    (cal_to_jd(1796), 14.0),
#    (cal_to_jd(1798), 13.0),
#
#    (cal_to_jd(1800), 13.1),
#    (cal_to_jd(1802), 12.5),
#    (cal_to_jd(1804), 12.2),
#    (cal_to_jd(1806), 12.0),
#    (cal_to_jd(1808), 12.0),
#
#    (cal_to_jd(1810), 12.0),
#    (cal_to_jd(1812), 12.0),
#    (cal_to_jd(1814), 12.0),
#    (cal_to_jd(1816), 12.0),
#    (cal_to_jd(1818), 11.9),
#
#    (cal_to_jd(1820), 11.6),
#    (cal_to_jd(1822), 11.0),
#    (cal_to_jd(1824), 10.2),
#    (cal_to_jd(1826), 9.2),
#    (cal_to_jd(1828), 8.2),
#
#    (cal_to_jd(1830), 7.1),
#    (cal_to_jd(1832), 6.2),
#    (cal_to_jd(1834), 5.6),
#    (cal_to_jd(1836), 5.4),
#    (cal_to_jd(1838), 5.3),
#
#    (cal_to_jd(1840), 5.4),
#    (cal_to_jd(1842), 5.6),
#    (cal_to_jd(1844), 5.9),
#    (cal_to_jd(1846), 6.2),
#    (cal_to_jd(1848), 6.5),
#
#    (cal_to_jd(1850), 6.8),
#    (cal_to_jd(1852), 7.1),
#    (cal_to_jd(1854), 7.3),
#    (cal_to_jd(1856), 7.5),
#    (cal_to_jd(1858), 7.6),
#
#    (cal_to_jd(1860), 7.7),
#    (cal_to_jd(1862), 7.3),
#    (cal_to_jd(1864), 6.2),
#    (cal_to_jd(1866), 5.2),
#    (cal_to_jd(1868), 2.7),
#
#    (cal_to_jd(1870), 1.4),
#    (cal_to_jd(1872), -1.2),
#    (cal_to_jd(1874), -2.8),
#    (cal_to_jd(1876), -3.8),
#    (cal_to_jd(1878), -4.8),
#
#    (cal_to_jd(1880), -5.5),
#    (cal_to_jd(1882), -5.3),
#    (cal_to_jd(1884), -5.6),
#    (cal_to_jd(1886), -5.7),
#    (cal_to_jd(1888), -5.9),
#
#    (cal_to_jd(1890), -6.0),
#    (cal_to_jd(1892), -6.3),
#    (cal_to_jd(1894), -6.5),
#    (cal_to_jd(1896), -6.2),
#    (cal_to_jd(1898), -4.7),
#
#    (cal_to_jd(1900), -2.8),
#    (cal_to_jd(1902), -0.1),
#    (cal_to_jd(1904), 2.6),
#    (cal_to_jd(1906), 5.3),
#    (cal_to_jd(1908), 7.7),
#
#    (cal_to_jd(1910), 10.4),
#    (cal_to_jd(1912), 13.3),
#    (cal_to_jd(1914), 16.0),
#    (cal_to_jd(1916), 18.2),
#    (cal_to_jd(1918), 20.2),
#
#    (cal_to_jd(1920), 21.1),
#    (cal_to_jd(1922), 22.4),
#    (cal_to_jd(1924), 23.5),
#    (cal_to_jd(1926), 23.8),
#    (cal_to_jd(1928), 24.3),
#
#    (cal_to_jd(1930), 24.0),
#    (cal_to_jd(1932), 23.9),
#    (cal_to_jd(1934), 23.9),
#    (cal_to_jd(1936), 23.7),
#    (cal_to_jd(1938), 24.0),
#
#    (cal_to_jd(1940), 24.3),
#    (cal_to_jd(1942), 25.3),
#    (cal_to_jd(1944), 26.2),
#    (cal_to_jd(1946), 27.3),
#    (cal_to_jd(1948), 28.2),
#
#    (cal_to_jd(1950), 29.1),
#    (cal_to_jd(1952), 30.0),
#    (cal_to_jd(1954), 30.7),
#    (cal_to_jd(1956), 31.4),
#    (cal_to_jd(1958), 32.2),
#
#    (cal_to_jd(1960), 33.1),
#    (cal_to_jd(1962), 34.0),
#    (cal_to_jd(1964), 35.0),
#    (cal_to_jd(1966), 36.5),
#    (cal_to_jd(1968), 38.3),
#
#    (cal_to_jd(1970), 40.2),
#    (cal_to_jd(1972), 42.2),
#    (cal_to_jd(1974), 44.5),
#    (cal_to_jd(1976), 46.5),
#    (cal_to_jd(1978), 48.5),
#
#    (cal_to_jd(1980), 50.5),
#    (cal_to_jd(1982), 52.2),
#    (cal_to_jd(1984), 53.8),
#    (cal_to_jd(1986), 54.9),
#    (cal_to_jd(1988), 55.8),
#
#    (cal_to_jd(1990), 56.9),
#    (cal_to_jd(1992), 58.3),
#    (cal_to_jd(1994), 60.0),
#    (cal_to_jd(1996), 61.6),
#    (cal_to_jd(1998), 63.0),
#
    (cal_to_jd(1657), 44),
    (cal_to_jd(1658), 43),
    (cal_to_jd(1659), 40),
    (cal_to_jd(1660), 38),
    (cal_to_jd(1661), 37),
    (cal_to_jd(1662), 36),
    (cal_to_jd(1663), 37),
    (cal_to_jd(1664), 38),
    (cal_to_jd(1665), 36),
    (cal_to_jd(1666), 35),
    (cal_to_jd(1667), 34),
    (cal_to_jd(1668), 33),
    (cal_to_jd(1669), 32),
    (cal_to_jd(1670), 31),
    (cal_to_jd(1671), 30),
    (cal_to_jd(1672), 29),
    (cal_to_jd(1673), 29),
    (cal_to_jd(1674), 28),
    (cal_to_jd(1675), 27),
    (cal_to_jd(1676), 26),
    (cal_to_jd(1677), 25),
    (cal_to_jd(1678), 25),
    (cal_to_jd(1679), 26),
    (cal_to_jd(1680), 26),
    (cal_to_jd(1681), 25),
    (cal_to_jd(1682), 24),
    (cal_to_jd(1683), 24),
    (cal_to_jd(1684), 24),
    (cal_to_jd(1685), 24),
    (cal_to_jd(1686), 24),
    (cal_to_jd(1687), 23),
    (cal_to_jd(1688), 23),
    (cal_to_jd(1689), 22),
    (cal_to_jd(1690), 22),
    (cal_to_jd(1691), 22),
    (cal_to_jd(1692), 21),
    (cal_to_jd(1693), 21),
    (cal_to_jd(1694), 21),
    (cal_to_jd(1695), 21),
    (cal_to_jd(1696), 20),
    (cal_to_jd(1697), 20),
    (cal_to_jd(1698), 20),
    (cal_to_jd(1699), 20),
    (cal_to_jd(1700), 21),
    (cal_to_jd(1701), 21),
    (cal_to_jd(1702), 20),
    (cal_to_jd(1703), 20),
    (cal_to_jd(1704), 19),
    (cal_to_jd(1705), 19),
    (cal_to_jd(1706), 19),
    (cal_to_jd(1707), 20),
    (cal_to_jd(1708), 20),
    (cal_to_jd(1709), 20),
    (cal_to_jd(1710), 20),
    (cal_to_jd(1711), 20),
    (cal_to_jd(1712), 21),
    (cal_to_jd(1713), 21),
    (cal_to_jd(1714), 21),
    (cal_to_jd(1715), 21),
    (cal_to_jd(1716), 21),
    (cal_to_jd(1717), 21),
    (cal_to_jd(1718), 21),
    (cal_to_jd(1719), 21),
    (cal_to_jd(1720), 21.1),
    (cal_to_jd(1721), 21.0),
    (cal_to_jd(1722), 20.9),
    (cal_to_jd(1723), 20.7),
    (cal_to_jd(1724), 20.4),
    (cal_to_jd(1725), 20.0),
    (cal_to_jd(1726), 19.4),
    (cal_to_jd(1727), 18.7),
    (cal_to_jd(1728), 17.8),
    (cal_to_jd(1729), 17.0),
    (cal_to_jd(1730), 16.6),
    (cal_to_jd(1731), 16.1),
    (cal_to_jd(1732), 15.7),
    (cal_to_jd(1733), 15.3),
    (cal_to_jd(1734), 14.7),
    (cal_to_jd(1735), 14.3),
    (cal_to_jd(1736), 14.1),
    (cal_to_jd(1737), 14.1),
    (cal_to_jd(1738), 13.7),
    (cal_to_jd(1739), 13.5),
    (cal_to_jd(1740), 13.5),
    (cal_to_jd(1741), 13.4),
    (cal_to_jd(1742), 13.4),
    (cal_to_jd(1743), 13.3),
    (cal_to_jd(1744), 13.2),
    (cal_to_jd(1745), 13.2),
    (cal_to_jd(1746), 13.1),
    (cal_to_jd(1747), 13.0),
    (cal_to_jd(1748), 13.3),
    (cal_to_jd(1749), 13.5),
    (cal_to_jd(1750), 13.7),
    (cal_to_jd(1751), 13.9),
    (cal_to_jd(1752), 14.0),
    (cal_to_jd(1753), 14.1),
    (cal_to_jd(1754), 14.1),
    (cal_to_jd(1755), 14.3),
    (cal_to_jd(1756), 14.4),
    (cal_to_jd(1757), 14.6),
    (cal_to_jd(1758), 14.7),
    (cal_to_jd(1759), 14.7),
    (cal_to_jd(1760), 14.8),
    (cal_to_jd(1761), 14.9),
    (cal_to_jd(1762), 15.0),
    (cal_to_jd(1763), 15.2),
    (cal_to_jd(1764), 15.4),
    (cal_to_jd(1765), 15.6),
    (cal_to_jd(1766), 15.6),
    (cal_to_jd(1767), 15.9),
    (cal_to_jd(1768), 15.9),
    (cal_to_jd(1769), 15.7),
    (cal_to_jd(1770), 15.7),
    (cal_to_jd(1771), 15.7),
    (cal_to_jd(1772), 15.9),
    (cal_to_jd(1773), 16.1),
    (cal_to_jd(1774), 15.9),
    (cal_to_jd(1775), 15.7),
    (cal_to_jd(1776), 15.3),
    (cal_to_jd(1777), 15.5),
    (cal_to_jd(1778), 15.6),
    (cal_to_jd(1779), 15.6),
    (cal_to_jd(1780), 15.6),
    (cal_to_jd(1781), 15.5),
    (cal_to_jd(1782), 15.4),
    (cal_to_jd(1783), 15.2),
    (cal_to_jd(1784), 14.9),
    (cal_to_jd(1785), 14.6),
    (cal_to_jd(1786), 14.3),
    (cal_to_jd(1787), 14.1),
    (cal_to_jd(1788), 14.2),
    (cal_to_jd(1789), 13.7),
    (cal_to_jd(1790), 13.3),
    (cal_to_jd(1791), 13.0),
    (cal_to_jd(1792), 13.2),
    (cal_to_jd(1793), 13.1),
    (cal_to_jd(1794), 13.3),
    (cal_to_jd(1795), 13.5),
    (cal_to_jd(1796), 13.2),
    (cal_to_jd(1797), 13.1),
    (cal_to_jd(1798), 13.0),
    (cal_to_jd(1799), 12.6),
    (cal_to_jd(1800), 12.6),
    (cal_to_jd(1801), 12.0),
    (cal_to_jd(1802), 11.8),
    (cal_to_jd(1803), 11.4),
    (cal_to_jd(1804), 11.1),
    (cal_to_jd(1805), 11.1),
    (cal_to_jd(1806), 11.1),
    (cal_to_jd(1807), 11.1),
    (cal_to_jd(1808), 11.2),
    (cal_to_jd(1809), 11.5),
    (cal_to_jd(1810), 11.2),
    (cal_to_jd(1811), 11.7),
    (cal_to_jd(1812), 11.9),
    (cal_to_jd(1813), 11.8),
    (cal_to_jd(1814), 11.8),
    (cal_to_jd(1815), 11.8),
    (cal_to_jd(1816), 11.6),
    (cal_to_jd(1817), 11.5),
    (cal_to_jd(1818), 11.4),
    (cal_to_jd(1819), 11.3),
    (cal_to_jd(1820), 11.13),
    (cal_to_jd(1821), 10.94),
    (cal_to_jd(1822), 10.29),
    (cal_to_jd(1823), 9.94),
    (cal_to_jd(1824), 9.88),
    (cal_to_jd(1825), 9.72),
    (cal_to_jd(1826), 9.66),
    (cal_to_jd(1827), 9.51),
    (cal_to_jd(1828), 9.21),
    (cal_to_jd(1829), 8.60),
    (cal_to_jd(1830), 7.95),
    (cal_to_jd(1831), 7.59),
    (cal_to_jd(1832), 7.36),
    (cal_to_jd(1833), 7.10),
    (cal_to_jd(1834), 6.89),
    (cal_to_jd(1835), 6.73),
    (cal_to_jd(1836), 6.39),
    (cal_to_jd(1837), 6.25),
    (cal_to_jd(1838), 6.25),
    (cal_to_jd(1839), 6.22),
    (cal_to_jd(1840), 6.22),
    (cal_to_jd(1841), 6.30),
    (cal_to_jd(1842), 6.35),
    (cal_to_jd(1843), 6.32),
    (cal_to_jd(1844), 6.33),
    (cal_to_jd(1845), 6.37),
    (cal_to_jd(1846), 6.40),
    (cal_to_jd(1847), 6.46),
    (cal_to_jd(1848), 6.48),
    (cal_to_jd(1849), 6.53),
    (cal_to_jd(1850), 6.55),
    (cal_to_jd(1851), 6.69),
    (cal_to_jd(1852), 6.84),
    (cal_to_jd(1853), 7.03),
    (cal_to_jd(1854), 7.15),
    (cal_to_jd(1855), 7.26),
    (cal_to_jd(1856), 7.23),
    (cal_to_jd(1857), 7.21),
    (cal_to_jd(1858), 6.99),
    (cal_to_jd(1859), 7.19),
    (cal_to_jd(1860), 7.35),
    (cal_to_jd(1861), 7.41),
    (cal_to_jd(1862), 7.36),
    (cal_to_jd(1863), 6.95),
    (cal_to_jd(1864), 6.45),
    (cal_to_jd(1865), 5.92),
    (cal_to_jd(1866), 5.15),
    (cal_to_jd(1867), 4.11),
    (cal_to_jd(1868), 2.94),
    (cal_to_jd(1869), 1.97),
    (cal_to_jd(1870), 1.04),
    (cal_to_jd(1871), 0.11),
    (cal_to_jd(1872), -0.82),
    (cal_to_jd(1873), -1.70),
    (cal_to_jd(1874), -2.48),
    (cal_to_jd(1875), -3.19),
    (cal_to_jd(1876), -3.84),
    (cal_to_jd(1877), -4.43),
    (cal_to_jd(1878), -4.79),
    (cal_to_jd(1879), -5.09),
    (cal_to_jd(1880), -5.36),
    (cal_to_jd(1881), -5.37),
    (cal_to_jd(1882), -5.34),
    (cal_to_jd(1883), -5.40),
    (cal_to_jd(1884), -5.58),
    (cal_to_jd(1885), -5.74),
    (cal_to_jd(1886), -5.69),
    (cal_to_jd(1887), -5.67),
    (cal_to_jd(1888), -5.73),
    (cal_to_jd(1889), -5.78),
    (cal_to_jd(1890), -5.86),
    (cal_to_jd(1891), -6.01),
    (cal_to_jd(1892), -6.28),
    (cal_to_jd(1893), -6.53),
    (cal_to_jd(1894), -6.50),
    (cal_to_jd(1895), -6.41),
    (cal_to_jd(1896), -6.11),
    (cal_to_jd(1897), -5.63),
    (cal_to_jd(1898), -4.68),
    (cal_to_jd(1899), -3.72),
    (cal_to_jd(1900), -2.70),
    (cal_to_jd(1901), -1.48),
    (cal_to_jd(1902), -0.08),
    (cal_to_jd(1903), 1.26),
    (cal_to_jd(1904), 2.59),
    (cal_to_jd(1905), 3.92),
    (cal_to_jd(1906), 5.20),
    (cal_to_jd(1907), 6.29),
    (cal_to_jd(1908), 7.68),
    (cal_to_jd(1909), 9.13),
    (cal_to_jd(1910), 10.38),
    (cal_to_jd(1911), 11.64),
    (cal_to_jd(1912), 13.23),
    (cal_to_jd(1913), 14.69),
    (cal_to_jd(1914), 16.00),
    (cal_to_jd(1915), 17.19),
    (cal_to_jd(1916), 18.19),
    (cal_to_jd(1917), 19.13),
    (cal_to_jd(1918), 20.14),
    (cal_to_jd(1919), 20.86),
    (cal_to_jd(1920), 21.41),
    (cal_to_jd(1921), 22.06),
    (cal_to_jd(1922), 22.51),
    (cal_to_jd(1923), 23.01),
    (cal_to_jd(1924), 23.46),
    (cal_to_jd(1925), 23.63),
    (cal_to_jd(1926), 23.95),
    (cal_to_jd(1927), 24.39),
    (cal_to_jd(1928), 24.34),
    (cal_to_jd(1929), 24.10),
    (cal_to_jd(1930), 24.02),
    (cal_to_jd(1931), 23.98),
    (cal_to_jd(1932), 23.89),
    (cal_to_jd(1933), 23.93),
    (cal_to_jd(1934), 23.88),
    (cal_to_jd(1935), 23.91),
    (cal_to_jd(1936), 23.76),
    (cal_to_jd(1937), 23.91),
    (cal_to_jd(1938), 23.96),
    (cal_to_jd(1939), 24.04),
    (cal_to_jd(1940), 24.35),
    (cal_to_jd(1941), 24.82),
    (cal_to_jd(1942), 25.30),
    (cal_to_jd(1943), 25.77),
    (cal_to_jd(1944), 26.27),
    (cal_to_jd(1945), 26.76),
    (cal_to_jd(1946), 27.27),
    (cal_to_jd(1947), 27.77),
    (cal_to_jd(1948), 28.25),
    (cal_to_jd(1949), 28.70),
    (cal_to_jd(1950), 29.15),
    (cal_to_jd(1951), 29.57),
    (cal_to_jd(1952), 29.97),
    (cal_to_jd(1953), 30.36),
    (cal_to_jd(1954), 30.72),
    (cal_to_jd(1955), 31.07),
    (cal_to_jd(1956), 31.349),
    (cal_to_jd(1957), 31.677),
    (cal_to_jd(1958), 32.166),
    (cal_to_jd(1959), 32.671),
    (cal_to_jd(1960), 33.150),
    (cal_to_jd(1961), 33.584),
    (cal_to_jd(1962), 33.992),
    (cal_to_jd(1963), 34.466),
    (cal_to_jd(1964), 35.030),
    (cal_to_jd(1965), 35.738),
    (cal_to_jd(1966), 36.546),
    (cal_to_jd(1967), 37.429),
    (cal_to_jd(1968), 38.291),
    (cal_to_jd(1969), 39.204),
    (cal_to_jd(1970), 40.182),
    (cal_to_jd(1971), 41.170),
    (cal_to_jd(1972), 42.227),
    (cal_to_jd(1973), 43.373),
    ( 2441714.5,    43.4724 ),
    ( 2441742.5,    43.5648 ),
    ( 2441773.5,    43.6737 ),
    ( 2441803.5,    43.7782 ),
    ( 2441834.5,    43.8763 ),
    ( 2441864.5,    43.9562 ),
    ( 2441895.5,    44.0315 ),
    ( 2441926.5,    44.1132 ),
    ( 2441956.5,    44.1982 ),
    ( 2441987.5,    44.2952 ),
    ( 2442017.5,    44.3936 ),
    ( 2442048.5,    44.4841 ),
    ( 2442079.5,    44.5646 ),
    ( 2442107.5,    44.6425 ),
    ( 2442138.5,    44.7386 ),
    ( 2442168.5,    44.8370 ),
    ( 2442199.5,    44.9302 ),
    ( 2442229.5,    44.9986 ),
    ( 2442260.5,    45.0584 ),
    ( 2442291.5,    45.1284 ),
    ( 2442321.5,    45.2064 ),
    ( 2442352.5,    45.2980 ),
    ( 2442382.5,    45.3897 ),
    ( 2442413.5,    45.4761 ),
    ( 2442444.5,    45.5633 ),
    ( 2442472.5,    45.6450 ),
    ( 2442503.5,    45.7375 ),
    ( 2442533.5,    45.8284 ),
    ( 2442564.5,    45.9133 ),
    ( 2442594.5,    45.9820 ),
    ( 2442625.5,    46.0408 ),
    ( 2442656.5,    46.1067 ),
    ( 2442686.5,    46.1825 ),
    ( 2442717.5,    46.2789 ),
    ( 2442747.5,    46.3713 ),
    ( 2442778.5,    46.4567 ),
    ( 2442809.5,    46.5445 ),
    ( 2442838.5,    46.6311 ),
    ( 2442869.5,    46.7302 ),
    ( 2442899.5,    46.8284 ),
    ( 2442930.5,    46.9247 ),
    ( 2442960.5,    46.9970 ),
    ( 2442991.5,    47.0709 ),
    ( 2443022.5,    47.1451 ),
    ( 2443052.5,    47.2362 ),
    ( 2443083.5,    47.3413 ),
    ( 2443113.5,    47.4319 ),
    ( 2443144.5,    47.5214 ),
    ( 2443175.5,    47.6049 ),
    ( 2443203.5,    47.6837 ),
    ( 2443234.5,    47.7781 ),
    ( 2443264.5,    47.8771 ),
    ( 2443295.5,    47.9687 ),
    ( 2443325.5,    48.0348 ),
    ( 2443356.5,    48.0942 ),
    ( 2443387.5,    48.1608 ),
    ( 2443417.5,    48.2460 ),
    ( 2443448.5,    48.3439 ),
    ( 2443478.5,    48.4355 ),
    ( 2443509.5,    48.5344 ),
    ( 2443540.5,    48.6325 ),
    ( 2443568.5,    48.7294 ),
    ( 2443599.5,    48.8365 ),
    ( 2443629.5,    48.9353 ),
    ( 2443660.5,    49.0319 ),
    ( 2443690.5,    49.1013 ),
    ( 2443721.5,    49.1591 ),
    ( 2443752.5,    49.2286 ),
    ( 2443782.5,    49.3070 ),
    ( 2443813.5,    49.4018 ),
    ( 2443843.5,    49.4945 ),
    ( 2443874.5,    49.5862 ),
    ( 2443905.5,    49.6805 ),
    ( 2443933.5,    49.7602 ),
    ( 2443964.5,    49.8556 ),
    ( 2443994.5,    49.9489 ),
    ( 2444025.5,    50.0347 ),
    ( 2444055.5,    50.1019 ),
    ( 2444086.5,    50.1622 ),
    ( 2444117.5,    50.2260 ),
    ( 2444147.5,    50.2968 ),
    ( 2444178.5,    50.3831 ),
    ( 2444208.5,    50.4599 ),
    ( 2444239.5,    50.5387 ),
    ( 2444270.5,    50.6161 ),
    ( 2444299.5,    50.6866 ),
    ( 2444330.5,    50.7658 ),
    ( 2444360.5,    50.8454 ),
    ( 2444391.5,    50.9187 ),
    ( 2444421.5,    50.9761 ),
    ( 2444452.5,    51.0278 ),
    ( 2444483.5,    51.0843 ),
    ( 2444513.5,    51.1538 ),
    ( 2444544.5,    51.2319 ),
    ( 2444574.5,    51.3063 ),
    ( 2444605.5,    51.3808 ),
    ( 2444636.5,    51.4526 ),
    ( 2444664.5,    51.5160 ),
    ( 2444695.5,    51.5985 ),
    ( 2444725.5,    51.6809 ),
    ( 2444756.5,    51.7573 ),
    ( 2444786.5,    51.8133 ),
    ( 2444817.5,    51.8532 ),
    ( 2444848.5,    51.9014 ),
    ( 2444878.5,    51.9603 ),
    ( 2444909.5,    52.0328 ),
    ( 2444939.5,    52.0985 ),
    ( 2444970.5,    52.1668 ),
    ( 2445001.5,    52.2316 ),
    ( 2445029.5,    52.2938 ),
    ( 2445060.5,    52.3680 ),
    ( 2445090.5,    52.4465 ),
    ( 2445121.5,    52.5180 ),
    ( 2445151.5,    52.5752 ),
    ( 2445182.5,    52.6178 ),
    ( 2445213.5,    52.6668 ),
    ( 2445243.5,    52.7340 ),
    ( 2445274.5,    52.8056 ),
    ( 2445304.5,    52.8792 ),
    ( 2445335.5,    52.9565 ),
    ( 2445366.5,    53.0445 ),
    ( 2445394.5,    53.1268 ),
    ( 2445425.5,    53.2197 ),
    ( 2445455.5,    53.3024 ),
    ( 2445486.5,    53.3747 ),
    ( 2445516.5,    53.4335 ),
    ( 2445547.5,    53.4778 ),
    ( 2445578.5,    53.5300 ),
    ( 2445608.5,    53.5845 ),
    ( 2445639.5,    53.6523 ),
    ( 2445669.5,    53.7256 ),
    ( 2445700.5,    53.7882 ),
    ( 2445731.5,    53.8367 ),
    ( 2445760.5,    53.8830 ),
    ( 2445791.5,    53.9443 ),
    ( 2445821.5,    54.0042 ),
    ( 2445852.5,    54.0536 ),
    ( 2445882.5,    54.0856 ),
    ( 2445913.5,    54.1084 ),
    ( 2445944.5,    54.1463 ),
    ( 2445974.5,    54.1914 ),
    ( 2446005.5,    54.2452 ),
    ( 2446035.5,    54.2958 ),
    ( 2446066.5,    54.3427 ),
    ( 2446097.5,    54.3911 ),
    ( 2446125.5,    54.4320 ),
    ( 2446156.5,    54.4898 ),
    ( 2446186.5,    54.5456 ),
    ( 2446217.5,    54.5977 ),
    ( 2446247.5,    54.6355 ),
    ( 2446278.5,    54.6532 ),
    ( 2446309.5,    54.6776 ),
    ( 2446339.5,    54.7174 ),
    ( 2446370.5,    54.7741 ),
    ( 2446400.5,    54.8253 ),
    ( 2446431.5,    54.8713 ),
    ( 2446462.5,    54.9161 ),
    ( 2446490.5,    54.9581 ),
    ( 2446521.5,    54.9997 ),
    ( 2446551.5,    55.0476 ),
    ( 2446582.5,    55.0912 ),
    ( 2446612.5,    55.1132 ),
    ( 2446643.5,    55.1328 ),
    ( 2446674.5,    55.1532 ),
    ( 2446704.5,    55.1898 ),
    ( 2446735.5,    55.2416 ),
    ( 2446765.5,    55.2838 ),
    ( 2446796.5,    55.3222 ),
    ( 2446827.5,    55.3613 ),
    ( 2446855.5,    55.4063 ),
    ( 2446886.5,    55.4629 ),
    ( 2446916.5,    55.5111 ),
    ( 2446947.5,    55.5524 ),
    ( 2446977.5,    55.5812 ),
    ( 2447008.5,    55.6004 ),
    ( 2447039.5,    55.6262 ),
    ( 2447069.5,    55.6656 ),
    ( 2447100.5,    55.7168 ),
    ( 2447130.5,    55.7698 ),
    ( 2447161.5,    55.8197 ),
    ( 2447192.5,    55.8615 ),
    ( 2447221.5,    55.9130 ),
    ( 2447252.5,    55.9663 ),
    ( 2447282.5,    56.0220 ),
    ( 2447313.5,    56.0700 ),
    ( 2447343.5,    56.0939 ),
    ( 2447374.5,    56.1105 ),
    ( 2447405.5,    56.1314 ),
    ( 2447435.5,    56.1611 ),
    ( 2447466.5,    56.2068 ),
    ( 2447496.5,    56.2583 ),
    ( 2447527.5,    56.3000 ),
    ( 2447558.5,    56.3399 ),
    ( 2447586.5,    56.3790 ),
    ( 2447617.5,    56.4283 ),
    ( 2447647.5,    56.4804 ),
    ( 2447678.5,    56.5352 ),
    ( 2447708.5,    56.5697 ),
    ( 2447739.5,    56.5983 ),
    ( 2447770.5,    56.6328 ),
    ( 2447800.5,    56.6739 ),
    ( 2447831.5,    56.7332 ),
    ( 2447861.5,    56.7972 ),
    ( 2447892.5,    56.8553 ),
    ( 2447923.5,    56.9111 ),
    ( 2447951.5,    56.9755 ),
    ( 2447982.5,    57.0471 ),
    ( 2448012.5,    57.1136 ),
    ( 2448043.5,    57.1738 ),
    ( 2448073.5,    57.2226 ),
    ( 2448104.5,    57.2597 ),
    ( 2448135.5,    57.3073 ),
    ( 2448165.5,    57.3643 ),
    ( 2448196.5,    57.4334 ),
    ( 2448226.5,    57.5016 ),
    ( 2448257.5,    57.5653 ),
    ( 2448288.5,    57.6333 ),
    ( 2448316.5,    57.6973 ),
    ( 2448347.5,    57.7711 ),
    ( 2448377.5,    57.8407 ),
    ( 2448408.5,    57.9058 ),
    ( 2448438.5,    57.9576 ),
    ( 2448469.5,    57.9975 ),
    ( 2448500.5,    58.0426 ),
    ( 2448530.5,    58.1043 ),
    ( 2448561.5,    58.1679 ),
    ( 2448591.5,    58.2389 ),
    ( 2448622.5,    58.3092 ),
    ( 2448653.5,    58.3833 ),
    ( 2448682.5,    58.4537 ),
    ( 2448713.5,    58.5401 ),
    ( 2448743.5,    58.6228 ),
    ( 2448774.5,    58.6917 ),
    ( 2448804.5,    58.7410 ),
    ( 2448835.5,    58.7836 ),
    ( 2448866.5,    58.8406 ),
    ( 2448896.5,    58.8986 ),
    ( 2448927.5,    58.9714 ),
    ( 2448957.5,    59.0438 ),
    ( 2448988.5,    59.1218 ),
    ( 2449019.5,    59.2003 ),
    ( 2449047.5,    59.2747 ),
    ( 2449078.5,    59.3574 ),
    ( 2449108.5,    59.4434 ),
    ( 2449139.5,    59.5242 ),
    ( 2449169.5,    59.5850 ),
    ( 2449200.5,    59.6344 ),
    ( 2449231.5,    59.6928 ),
    ( 2449261.5,    59.7588 ),
    ( 2449292.5,    59.8386 ),
    ( 2449322.5,    59.9111 ),
    ( 2449353.5,    59.9845 ),
    ( 2449384.5,    60.0564 ),
    ( 2449412.5,    60.1231 ),
    ( 2449443.5,    60.2042 ),
    ( 2449473.5,    60.2804 ),
    ( 2449504.5,    60.3530 ),
    ( 2449534.5,    60.4012 ),
    ( 2449565.5,    60.4440 ),
    ( 2449596.5,    60.4900 ),
    ( 2449626.5,    60.5578 ),
    ( 2449657.5,    60.6324 ),
    ( 2449687.5,    60.7059 ),
    ( 2449718.5,    60.7853 ),
    ( 2449749.5,    60.8664 ),
    ( 2449777.5,    60.9387 ),
    ( 2449808.5,    61.0277 ),
    ( 2449838.5,    61.1103 ),
    ( 2449869.5,    61.1870 ),
    ( 2449899.5,    61.2454 ),
    ( 2449930.5,    61.2881 ),
    ( 2449961.5,    61.3378 ),
    ( 2449991.5,    61.4036 ),
    ( 2450022.5,    61.4760 ),
    ( 2450052.5,    61.5525 ),
    ( 2450083.5,    61.6287 ),
    ( 2450114.5,    61.6846 ),
    ( 2450143.5,    61.7433 ),
    ( 2450174.5,    61.8132 ),
    ( 2450204.5,    61.8823 ),
    ( 2450235.5,    61.9497 ),
    ( 2450265.5,    61.9969 ),
    ( 2450296.5,    62.0343 ),
    ( 2450327.5,    62.0714 ),
    ( 2450357.5,    62.1202 ),
    ( 2450388.5,    62.1810 ),
    ( 2450418.5,    62.2382 ),
    ( 2450449.5,    62.2950 ),
    ( 2450480.5,    62.3506 ),
    ( 2450508.5,    62.3995 ),
    ( 2450539.5,    62.4754 ),
    ( 2450569.5,    62.5463 ),
    ( 2450600.5,    62.6136 ),
    ( 2450630.5,    62.6571 ),
    ( 2450661.5,    62.6942 ),
    ( 2450692.5,    62.7383 ),
    ( 2450722.5,    62.7926 ),
    ( 2450753.5,    62.8567 ),
    ( 2450783.5,    62.9146 ),
    ( 2450814.5,    62.9659 ),
    ( 2450845.5,    63.0217 ),
    ( 2450873.5,    63.0807 ),
    ( 2450904.5,    63.1462 ),
    ( 2450934.5,    63.2053 ),
    ( 2450965.5,    63.2599 ),
    ( 2450995.5,    63.2844 ),
    ( 2451026.5,    63.2961 ),
    ( 2451057.5,    63.3126 ),
    ( 2451087.5,    63.3422 ),
    ( 2451118.5,    63.3871 ),
    ( 2451148.5,    63.4339 ),
    ( 2451179.5,    63.4673 ),
    ( 2451210.5,    63.4979 ),
    ( 2451238.5,    63.5319 ),
    ( 2451269.5,    63.5679 ),
    ( 2451299.5,    63.6104 ),
    ( 2451330.5,    63.6444 ),
    ( 2451360.5,    63.6642 ),
    ( 2451391.5,    63.6739 ),
    ( 2451422.5,    63.6926 ),
    ( 2451452.5,    63.7147 ),
    ( 2451483.5,    63.7518 ),
    ( 2451513.5,    63.7927 ),
    ( 2451544.5,    63.8285 ),
    ( 2451575.5,    63.8557 ),
    ( 2451604.5,    63.8804 ),
    ( 2451635.5,    63.9075 ),
    ( 2451665.5,    63.9393 ),
    ( 2451696.5,    63.9691 ),
    ( 2451726.5,    63.9799 ),
    ( 2451757.5,    63.9833 ),
    ( 2451788.5,    63.9938 ),
    ( 2451818.5,    64.0093 ),
    ( 2451849.5,    64.0400 ),
    ( 2451879.5,    64.0670 ),
    ( 2451910.5,    64.0908 ),
    ( 2451941.5,    64.1068 ),
    ( 2451969.5,    64.1282 ),
    ( 2452000.5,    64.1584 ),
    ( 2452030.5,    64.1833 ),
    ( 2452061.5,    64.2094 ),
    ( 2452091.5,    64.2117 ),
    ( 2452122.5,    64.2073 ),
    ( 2452153.5,    64.2116 ),
    ( 2452183.5,    64.2223 ),
    ( 2452214.5,    64.2500 ),
    ( 2452244.5,    64.2761 ),
    ( 2452275.5,    64.2998 ),
    ( 2452306.5,    64.3192 ),
    ( 2452334.5,    64.3450 ),
    ( 2452365.5,    64.3735 ),
    ( 2452395.5,    64.3943 ),
    ( 2452426.5,    64.4151 ),
    ( 2452456.5,    64.4132 ),
    ( 2452487.5,    64.4118 ),
    ( 2452518.5,    64.4097 ),
    ( 2452548.5,    64.4168 ),
    ( 2452579.5,    64.4329 ),
    ( 2452609.5,    64.4511 ),
    ( 2452640.5,    64.4734 ),
    ( 2452671.5,    64.4893 ),
    ( 2452699.5,    64.5053 ),
    ( 2452730.5,    64.5269 ),
    ( 2452760.5,    64.5471 ),
    ( 2452791.5,    64.5597 ),
    ( 2452821.5,    64.5512 ),
    ( 2452852.5,    64.5371 ),
    ( 2452883.5,    64.5359 ),
    ( 2452913.5,    64.5415 ),
    ( 2452944.5,    64.5544 ),
    ( 2452974.5,    64.5654 ),
    ( 2453005.5,    64.5736 ),
    ( 2453036.5,    64.5891 ),
    ( 2453065.5,    64.6015 ),
    ( 2453096.5,    64.6176 ),
    ( 2453126.5,    64.6374 ),
    ( 2453157.5,    64.6549 ),
    ( 2453187.5,    64.6530 ),
    ( 2453218.5,    64.6379 ),
    ( 2453249.5,    64.6372 ),
    ( 2453279.5,    64.6400 ),
    ( 2453310.5,    64.6543 ),
    ( 2453340.5,    64.6723 ),
    ( 2453371.5,    64.6876 ),
    ( 2453402.5,    64.7052 ),
    ( 2453430.5,    64.7313 ),
    ( 2453461.5,    64.7575 ),
    ( 2453491.5,    64.7811 ),
    ( 2453522.5,    64.8001 ),
    ( 2453552.5,    64.7995 ),
    ( 2453583.5,    64.7876 ),
    ( 2453614.5,    64.7831 ),
    ( 2453644.5,    64.7921 ),
    ( 2453675.5,    64.8096 ),
    ( 2453705.5,    64.8311 ),
    ( 2453736.5,    64.8452 ),
    ( 2453767.5,    64.8597 ),
    ( 2453795.5,    64.8850 ),
    ( 2453826.5,    64.9175 ),
    ( 2453856.5,    64.9480 ),
    ( 2453887.5,    64.9794 ),
    ( 2453917.5,    64.9895 ),
    ( 2453948.5,    65.0028 ),
    ( 2453979.5,    65.0138 ),
    ( 2454009.5,    65.0371 ),
    ( 2454040.5,    65.0773 ),
    ( 2454070.5,    65.1122 ),
    ( 2454101.5,    65.1464 ),
    ( 2454132.5,    65.1833 ),
    ( 2454160.5,    65.2145 ),
    ( 2454191.5,    65.2494 ),
    ( 2454221.5,    65.2921 ),
    ( 2454252.5,    65.3279 ),
    ( 2454282.5,    65.3413 ),
    ( 2454313.5,    65.3452 ),
    ( 2454344.5,    65.3496 ),
    ( 2454374.5,    65.3711 ),
    ( 2454405.5,    65.3972 ),
    ( 2454435.5,    65.4296 ),
    ( 2454466.5,    65.4573 ),
    ( 2454497.5,    65.4868 ),
    ( 2454526.5,    65.5152 ),
    ( 2454557.5,    65.5450 ),
    ( 2454587.5,    65.5781 ),
    ( 2454618.5,    65.6127 ),
    ( 2454648.5,    65.6288 ),
    ( 2454679.5,    65.6370 ),
    ( 2454710.5,    65.6493 ),
    ( 2454740.5,    65.6760 ),
    ( 2454771.5,    65.7097 ),
    ( 2454801.5,    65.7461 ),
    ( 2454832.5,    65.7768 ),
    ( 2454863.5,    65.8025 ),
    ( 2454891.5,    65.8237 ),
    ( 2454922.5,    65.8595 ),
    ( 2454952.5,    65.8973 ),
    ( 2454983.5,    65.9323 ),
    ( 2455013.5,    65.9509 ),
    ( 2455044.5,    65.9534 ),
    ( 2455075.5,    65.9628 ),
    ( 2455105.5,    65.9839 ),
    ( 2455136.5,    66.0147 ),
    ( 2455166.5,    66.0420 ),
    ( 2455197.5,    66.0699 ),
    ( 2455228.5,    66.0961 ),
    ( 2455256.5,    66.1310 ),
    ( 2455287.5,    66.1683 ),
    ( 2455317.5,    66.2072 ),
    ( 2455348.5,    66.2356 ),
    ( 2455378.5,    66.2409 ),
    ( 2455409.5,    66.2335 ),
    ( 2455440.5,    66.2349 ),
    ( 2455470.5,    66.2441 ),
    ( 2455501.5,    66.2751 ),
    ( 2455531.5,    66.3054 ),
    ( 2455562.5,    66.3246 ),
    ( 2455593.5,    66.3406 ),
    ( 2455621.5,    66.3624 ),
    ( 2455652.5,    66.3957 ),
    ( 2455682.5,    66.4289 ),
    ( 2455713.5,    66.4619 ),
    ( 2455743.5,    66.4749 ),
    ( 2455774.5,    66.4751 ),
    ( 2455805.5,    66.4829 ),
    ( 2455835.5,    66.5056 ),
    ( 2455866.5,    66.5383 ),
    ( 2455896.5,    66.5706 ),
    ( 2455927.5,    66.6030 ),
    ( 2455958.5,    66.6340 ),
    ( 2455987.5,    66.6569 ),
    ( 2456018.5,  66.6925 ),
    ( 2456110.50, 66.761  ),   # All these final values are predicted values from Year 2012.50 to Year  2021 as taken from http://maia.usno.navy.mil/ser7/deltat.preds
    ( 2456202.00, 66.792  ),
    ( 2456293.50, 67.1    ),
    ( 2456384.75, 67.2    ),
    ( 2456476.00, 67.3    ),
    ( 2456567.25, 67.5    ),
    ( 2456658.50, 67.6    ),
    ( 2456749.75, 67.7    ),
    ( 2456841.00, 67.8    ),
    ( 2456932.25, 67.9    ),
# At this point, per AAPLUS advice, move to equations rather than
# interpolate from table.  Naughter (AAPLUS developer) starts equation
# in April, but I have to end the table on a January 1st.
#    ( 2457023.50, 68.0    ),
#    ( 2457114.75, 68.2    ),
#    ( 2457206.00, 68      ),
#    ( 2457297.25, 68      ),
#    ( 2457388.50, 69      ),
#    ( 2457480.00, 69      ),
#    ( 2457571.50, 69      ),
#    ( 2457663.00, 69      ),
#    ( 2457754.50, 69      ),
#    ( 2457845.75, 69      ),
#    ( 2457937.00, 69      ),
#    ( 2458028.25, 69      ),
#    ( 2458119.50, 69      ),
#    ( 2458210.75, 70      ),
#    ( 2458302.00, 70      ),
#    ( 2458393.25, 70      ),
#    ( 2458484.50, 70      ),
#    ( 2458575.75, 70      ),
#    ( 2458667.00, 70      ),
#    ( 2458758.25, 70      ),
#    ( 2458849.50, 70      ),
#    ( 2458941.00, 71      ),
#    ( 2459032.50, 71      ),
#    ( 2459124.00, 71      ),
#    ( 2459215.50, 71      ),
]

_tbl_start = 1620
_tbl_end = 2015


def deltaT_seconds(jd):
    """Return deltaT as seconds of time.

    For a historical range from 1620 to a recent year, we interpolate from a
    table of observed values. Outside that range we use formulae.

    Arguments:
      - `jd` : (int) Julian Day number

    Returns:
      - deltaT in seconds

    """
    yr, mo, day = jd_to_cal(jd)
    #
    # 1620 - 20xx
    #
    if _tbl_start < yr < _tbl_end:
        idx = bisect(_tbl, (jd, 0))
        jd1, secs1 = _tbl[idx]
        jd0, secs0 = _tbl[idx-1]
        # simple linear interpolation between two values
        return ((jd - jd0) * (secs1 - secs0) / (jd1 - jd0)) + secs0

    # I decided to replicate with the equations below.
    # Naughter claims that this is better since there are
    # no discontinuties.
    if (yr < -500):
        t = (yr - 1820)/100.0
        result = polynomial([-20, 0, 32], t)
    elif (yr < 500):
        t = yr/100.0
        result = polynomial([10583.6,
                           -1014.41,
                           33.78311,
                           -5.952053,
                           -0.1798452,
                           0.022174192,
                           0.0090316521])
    elif (yr < 1600):
        t = (yr - 1000)/100.0
        result = polynomial([1574.2,
                           -556.01,
                           71.23472,
                           0.319781,
                           -0.8503463,
                           -0.005050998,
                           0.0083572073], t)
    elif (yr < 1700):
        t = (yr -1600)/100.0
        result = polynomial([120, -98.08, -153.2, 1/0.007129], t)
    elif (yr < 1800):
        t = (yr -1700)/100.0
        result = polynomial([8.83, 16.03, -59.285, 133.36, -1/0.01174], t)
    elif (yr < 1860):
        t = (yr -1800)/100.0
        result = polynomial([13.72, -33.2447, 68.612, 4111.6, -37436, 121272, -169900, 87500], t)
    elif (yr < 1900):
        t = (yr -1860)/100.0
        result = polynomial([7.62, 57.37, -2517.54, 16806.68, -44736.24, 1/0.0000233174], t)
    elif (yr < 1920):
        t = (yr -1900)/100.0
        result = polynomial([-2.79, 149.4119, -598.939, 6196.6, -19700], t)
    elif (yr < 1941):
        t = (yr -1920)/100.0
        result = polynomial([21.20, 84.493, -761.00, 2093.6], t)
    elif (yr < 1961):
        t = (yr -1950)/100.0
        result = polynomial([29.07, 40.7, -1/0.0233, 1/0.002547], t)
    elif (yr < 1986):
        t = (yr -1975)/100.0
        result = polynomial([45.45, 106.7, -1/0.026, -1/0.000718], t)
    elif (yr < 2005):
        t = (yr -2000)/100.0
        result = polynomial([63.86, 33.45, -603.74, 1727.5, 65181.4, 237359.9], t)
    elif (yr < 2050):
        t = (yr -2000)/100.0
        result = polynomial([62.92, 32.217, 55.89], t)
    elif (yr < 2150):
        t = (yr - 1820)/100.0
        result = polynomial([-205.72, 56.28, 32], t)
    else:
        t = (yr - 1820)/100.0
        result = polynomial([-20.0, 0.0, 32.0], t)

    return result


def dt_to_ut(jd):
    """Convert Julian Day from dynamical to universal time.

    Arguments:
      - `jd` : (int) Julian Day number (dynamical time)

    Returns:
      - Julian Day number : (int) (universal time)

    """
    return jd - deltaT_seconds(jd) / seconds_per_day
